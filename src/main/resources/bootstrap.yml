server:
  port: 8280
  context-path: /order-service

spring:
  application:
    name: order-service
  cloud:
    bus:
      enabled: false
    config:
      enabled: false

eureka:
  client:
    enabled: false

# This is the setup per http request
account-service:
  ribbon:
    listOfServers: localhost:8380
    ConnectTimeout: 11000
    ReadTimeout: 12000
    MaxAutoRetries: 1
    MaxAutoRetriesNextServer: 0

stock-service:
  ribbon:
    listOfServers: localhost:8480
    ConnectTimeout: 11000


hystrix:
  command:
    account-service:
      execution:
        timeout:
          enabled: false
#        isolation:
#          thread:
#            strategy: THREAD
#            timeoutInMilliseconds: 10000
      fallback.isolation.semaphore.maxConcurrentRequests: 200
  threadpool:
    account-service:
      coreSize: 20
      maxQueueSize: 500000
      keepAliveTimeMinutes: 2
      queueSizeRejectionThreshold: 500000

# This is for connection manager setup, default time to live unit is second
feign:
  httpclient:
    max-connections-per-route: 41
    max-connections: 101
    time-to-live: 120
  hystrix:
    enabled: true
  client:
    config:
      stock-service:
        connect-timeout: 13000

logging:
  level:
    wei:
      config:
        HttpClientConfig: DEBUG
        AppConfig: DEBUG
      web:
        client:
          AccountService: DEBUG
    org.apache.http.impl.conn.PoolingHttpClientConnectionManager: DEBUG
    org:
      springframework:
        retry:
          support: DEBUG
        cloud:
          netflix:
            feign:
              ribbon: DEBUG


---

spring:
  profiles: config
  cloud:
    config:
      uri: ${CONFIG_SERVER_URI:http://localhost:9000}
      enabled: true
    bus:
      enabled: true

---

spring:
  profiles: registry

eureka:
  client:
    serviceUrl:
      defaultZone: ${EUREKA_URI:http://localhost:8761/eureka}
    enabled: true
  instance:
    preferIpAddress: true
    hostname: ${HOST_NAME:localhost}